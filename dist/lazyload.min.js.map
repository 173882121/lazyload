{"version":3,"sources":["lazyload.js"],"names":["global","factory","exports","_typeof","module","define","amd","LazyLoad","this","value","elements","element","inViewportDataName","setSources","settings","force","setWasProcessed","callCallback","callback_enter","managedTags","indexOf","tagName","addOneShotListeners","addClass","isIntersecting","class_loading","getObserverSettings","getInstanceSettings","customSettings","defaultSettings","elements_selector","container","threshold","document","data_src","data_srcset","data_sizes","class_loaded","class_error","load_delay","callback_load","callback_error","to_webp","attribute","trueString","setData","getAttribute","dataPrefix","setAttribute","getData","setInViewport","arguments","length","undefined","getWasProcessed","getInViewport","createInstance","event","instance","purgeElements","CustomEvent","detail","err","createEvent","classObj","window","eventString","replaceExtToWebp","condition","detectWebp","canvas","runningOnBrowser","getContext","userAgent","supportsIntersectionObserver","supportsClassList","createElement","supportsWebp","optionsItem","toDataURL","setSourcesInChildren","parentTag","attrName","dataAttrName","toWebpFlag","childTag","i","children","attrValue","setAttributeIfValue","setSourcesImg","setSourcesBgImage","srcDataValue","setValue","style","backgroundImage","VIDEO","IMG","parentNode","parent","sizesDataValue","srcsetDataValue","setSourcesIframe","IFRAME","setSourcesVideo","srcDataName","setSourcesFunction","setSourcesFunctions","className","add","removeClass","remove","replace","RegExp","callback","loadString","argument","errorString","onLoad","loadHandler","errorHandler","onEvent","removeListeners","onError","addEventListener","success","loadObserved","target","revealElement","observer","unobserve","loadDelay","delayLoad","setTimeout","entry","intersectionRatio","root","_settings","rootMargin","_setObserver","update","prototype","_manageIntersection","_observer","_onIntersection","entries","forEach","bind","_elements","IntersectionObserver","loadAll","_this","load","nodeSet","_this2","isBot","querySelectorAll","Array","slice","call","destroy","_this3","options","autoInitialize","lazyLoadOptions"],"mappings":"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","file":"lazyload.min.js","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.LazyLoad = factory());\n}(this, (function () { 'use strict';\n\nvar getInstanceSettings = customSettings => {\r\n\tconst defaultSettings = {\r\n\t\telements_selector: \"img\",\r\n\t\tcontainer: document,\r\n\t\tthreshold: 300,\r\n\t\tdata_src: \"src\",\r\n\t\tdata_srcset: \"srcset\",\r\n\t\tdata_sizes: \"sizes\",\r\n\t\tclass_loading: \"loading\",\r\n\t\tclass_loaded: \"loaded\",\r\n\t\tclass_error: \"error\",\r\n\t\tload_delay: 0,\r\n\t\tcallback_load: null,\r\n\t\tcallback_error: null,\r\n\t\tcallback_set: null,\r\n\t\tcallback_enter: null,\r\n\t\tto_webp: false\r\n\t};\r\n\r\n\treturn Object.assign({}, defaultSettings, customSettings);\r\n};\n\nconst dataPrefix = \"data-\";\r\nconst processedDataName = \"was-processed\";\r\nconst inViewportDataName = \"in-viewport\";\r\nconst trueString = \"true\";\r\n\r\nconst getData = (element, attribute) => {\r\n\treturn element.getAttribute(dataPrefix + attribute);\r\n};\r\n\r\nconst setData = (element, attribute, value) => {\r\n\treturn element.setAttribute(dataPrefix + attribute, value);\r\n};\r\n\r\nconst setWasProcessed = element =>\r\n\tsetData(element, processedDataName, trueString);\r\n\r\nconst getWasProcessed = element =>\r\n\tgetData(element, processedDataName) === trueString;\r\n\r\nconst setInViewport = (element, value = trueString) =>\r\n\tsetData(element, inViewportDataName, value);\r\n\r\nconst getInViewport = element =>\r\n\tgetData(element, inViewportDataName) === trueString;\n\nfunction purgeElements(elements) {\r\n\treturn elements.filter(element => !getWasProcessed(element));\r\n}\n\n/* Creates instance and notifies it through the window element */\r\nconst createInstance = function(classObj, options) {\r\n\tvar event;\r\n\tlet eventString = \"LazyLoad::Initialized\";\r\n\tlet instance = new classObj(options);\r\n\ttry {\r\n\t\t// Works in modern browsers\r\n\t\tevent = new CustomEvent(eventString, { detail: { instance } });\r\n\t} catch (err) {\r\n\t\t// Works in Internet Explorer (all versions)\r\n\t\tevent = document.createEvent(\"CustomEvent\");\r\n\t\tevent.initCustomEvent(eventString, false, false, { instance });\r\n\t}\r\n\twindow.dispatchEvent(event);\r\n};\r\n\r\n/* Auto initialization of one or more instances of lazyload, depending on the \r\n    options passed in (plain object or an array) */\r\nfunction autoInitialize(classObj, options) {\r\n\tif (!options) {\r\n\t\treturn;\r\n\t}\r\n\tif (!options.length) {\r\n\t\t// Plain object\r\n\t\tcreateInstance(classObj, options);\r\n\t} else {\r\n\t\t// Array of objects\r\n\t\tfor (let i = 0, optionsItem; (optionsItem = options[i]); i += 1) {\r\n\t\t\tcreateInstance(classObj, optionsItem);\r\n\t\t}\r\n\t}\r\n}\n\nconst replaceExtToWebp = (value, condition) =>\n\tcondition ? value.replace(/\\.(jpe?g|png)/gi, \".webp\") : value;\n\nconst detectWebp = () => {\n\tvar webpString = \"image/webp\";\n\tvar canvas = document.createElement(\"canvas\");\n\n\tif (canvas.getContext && canvas.getContext(\"2d\")) {\n\t\treturn canvas.toDataURL(webpString).indexOf(`data:${webpString}`) === 0;\n\t}\n\n\treturn false;\n};\n\nconst runningOnBrowser = typeof window !== \"undefined\";\r\n\r\nconst isBot =\r\n\t(runningOnBrowser && !(\"onscroll\" in window)) ||\r\n\t/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent);\r\n\r\nconst supportsIntersectionObserver =\r\n\trunningOnBrowser && \"IntersectionObserver\" in window;\r\n\r\nconst supportsClassList =\r\n\trunningOnBrowser && \"classList\" in document.createElement(\"p\");\r\n\r\nconst supportsWebp = runningOnBrowser && detectWebp();\n\nconst setSourcesInChildren = function(\r\n\tparentTag,\r\n\tattrName,\r\n\tdataAttrName,\r\n\ttoWebpFlag\r\n) {\r\n\tfor (let i = 0, childTag; (childTag = parentTag.children[i]); i += 1) {\r\n\t\tif (childTag.tagName === \"SOURCE\") {\r\n\t\t\tlet attrValue = getData(childTag, dataAttrName);\r\n\t\t\tsetAttributeIfValue(childTag, attrName, attrValue, toWebpFlag);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst setAttributeIfValue = function(\r\n\telement,\r\n\tattrName,\r\n\tvalue,\r\n\ttoWebpFlag\r\n) {\r\n\tif (!value) {\r\n\t\treturn;\r\n\t}\r\n\telement.setAttribute(attrName, replaceExtToWebp(value, toWebpFlag));\r\n};\r\n\r\nconst setSourcesImg = (element, settings) => {\r\n\tconst toWebpFlag = supportsWebp && settings.to_webp;\r\n\tconst srcsetDataName = settings.data_srcset;\r\n\tconst parent = element.parentNode;\r\n\r\n\tif (parent && parent.tagName === \"PICTURE\") {\r\n\t\tsetSourcesInChildren(parent, \"srcset\", srcsetDataName, toWebpFlag);\r\n\t}\r\n\tconst sizesDataValue = getData(element, settings.data_sizes);\r\n\tsetAttributeIfValue(element, \"sizes\", sizesDataValue);\r\n\tconst srcsetDataValue = getData(element, srcsetDataName);\r\n\tsetAttributeIfValue(element, \"srcset\", srcsetDataValue, toWebpFlag);\r\n\tconst srcDataValue = getData(element, settings.data_src);\r\n\tsetAttributeIfValue(element, \"src\", srcDataValue, toWebpFlag);\r\n};\r\n\r\nconst setSourcesIframe = (element, settings) => {\r\n\tconst srcDataValue = getData(element, settings.data_src);\r\n\r\n\tsetAttributeIfValue(element, \"src\", srcDataValue);\r\n};\r\n\r\nconst setSourcesVideo = (element, settings) => {\r\n\tconst srcDataName = settings.data_src;\r\n\tconst srcDataValue = getData(element, srcDataName);\r\n\r\n\tsetSourcesInChildren(element, \"src\", srcDataName);\r\n\tsetAttributeIfValue(element, \"src\", srcDataValue);\r\n};\r\n\r\nconst setSourcesBgImage = (element, settings) => {\r\n\tconst toWebpFlag = supportsWebp && settings.to_webp;\r\n\tconst srcDataValue = getData(element, settings.data_src);\r\n\r\n\tif (srcDataValue) {\r\n\t\tlet setValue = replaceExtToWebp(srcDataValue, toWebpFlag);\r\n\t\telement.style.backgroundImage = `url(\"${setValue}\")`;\r\n\t}\r\n};\r\n\r\nconst setSourcesFunctions = {\r\n\tIMG: setSourcesImg,\r\n\tIFRAME: setSourcesIframe,\r\n\tVIDEO: setSourcesVideo\r\n};\r\n\r\nconst setSources = (element, settings) => {\r\n\tconst tagName = element.tagName;\r\n\tconst setSourcesFunction = setSourcesFunctions[tagName];\r\n\tif (setSourcesFunction) {\r\n\t\tsetSourcesFunction(element, settings);\r\n\t\treturn;\r\n\t}\r\n\tsetSourcesBgImage(element, settings);\r\n};\n\nconst addClass = (element, className) => {\r\n\tif (supportsClassList) {\r\n\t\telement.classList.add(className);\r\n\t\treturn;\r\n\t}\r\n\telement.className += (element.className ? \" \" : \"\") + className;\r\n};\r\n\r\nconst removeClass = (element, className) => {\r\n\tif (supportsClassList) {\r\n\t\telement.classList.remove(className);\r\n\t\treturn;\r\n\t}\r\n\telement.className = element.className.\r\n\t\treplace(new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\"), \" \").\r\n\t\treplace(/^\\s+/, \"\").\r\n\t\treplace(/\\s+$/, \"\");\r\n};\n\nconst managedTags = [\"IMG\", \"IFRAME\", \"VIDEO\"];\r\n\r\nconst callCallback = function(callback, argument) {\r\n\tif (callback) {\r\n\t\tcallback(argument);\r\n\t}\r\n};\r\n\r\nconst loadString = \"load\";\r\nconst errorString = \"error\";\r\n\r\nconst removeListeners = function(element, loadHandler, errorHandler) {\r\n\telement.removeEventListener(loadString, loadHandler);\r\n\telement.removeEventListener(errorString, errorHandler);\r\n};\r\n\r\nconst addOneShotListeners = function(element, settings) {\r\n\tconst onLoad = event => {\r\n\t\tonEvent(event, true, settings);\r\n\t\tremoveListeners(element, onLoad, onError);\r\n\t};\r\n\tconst onError = event => {\r\n\t\tonEvent(event, false, settings);\r\n\t\tremoveListeners(element, onLoad, onError);\r\n\t};\r\n\telement.addEventListener(loadString, onLoad);\r\n\telement.addEventListener(errorString, onError);\r\n};\r\n\r\nconst onEvent = function(event, success, settings) {\r\n\tconst element = event.target;\r\n\tremoveClass(element, settings.class_loading);\r\n\taddClass(element, success ? settings.class_loaded : settings.class_error); // Setting loaded or error class\r\n\tcallCallback(\r\n\t\tsuccess ? settings.callback_load : settings.callback_error,\r\n\t\telement\r\n\t);\r\n};\r\n\r\nconst loadObserved = (element, observer, settings) => {\r\n\trevealElement(element, settings);\r\n\tobserver.unobserve(element);\r\n};\r\n\r\nconst delayLoad = (element, observer, settings) => {\r\n\tvar loadDelay = settings.load_delay;\r\n\tsetTimeout(() => {\r\n\t\tif (getInViewport(element)) {\r\n\t\t\tloadObserved(element, observer, settings);\r\n\t\t}\r\n\t}, loadDelay);\r\n};\r\n\r\nfunction revealElement(element, settings, force) {\r\n\tif (!force && getWasProcessed(element)) {\r\n\t\treturn; // element has already been processed and force wasn't true\r\n\t}\r\n\tcallCallback(settings.callback_enter, element);\r\n\tif (managedTags.indexOf(element.tagName) > -1) {\r\n\t\taddOneShotListeners(element, settings);\r\n\t\taddClass(element, settings.class_loading);\r\n\t}\r\n\tsetSources(element, settings);\r\n\tsetWasProcessed(element);\r\n\tcallCallback(settings.callback_set, element);\r\n}\n\n/* entry.isIntersecting needs fallback because is null on some versions of MS Edge, and\r\n   entry.intersectionRatio is not enough alone because it could be 0 on some intersecting elements */\r\nconst isIntersecting = entry =>\r\n\tentry.isIntersecting || entry.intersectionRatio > 0;\r\n\r\nconst getObserverSettings = settings => ({\r\n\troot: settings.container === document ? null : settings.container,\r\n\trootMargin: settings.threshold + \"px\",\r\n\tthreshold: 0\r\n});\n\nconst LazyLoad = function(customSettings, elements) {\r\n\tthis._settings = getInstanceSettings(customSettings);\r\n\tthis._setObserver();\r\n\tthis.update(elements);\r\n};\r\n\r\nLazyLoad.prototype = {\r\n\t_manageIntersection: function(entry) {\r\n\t\tvar loadDelay = this._settings.load_delay;\r\n\t\tvar element = entry.target;\r\n\t\tif (isIntersecting(entry)) {\r\n\t\t\tif (loadDelay === 0) {\r\n\t\t\t\tloadObserved(element, this._observer, this._settings);\r\n\t\t\t} else {\r\n\t\t\t\tdelayLoad(element, this._observer, this._settings);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Writes in and outs in a data-attribute\r\n\t\tif (isIntersecting(entry)) {\r\n\t\t\tsetInViewport(element);\r\n\t\t} else {\r\n\t\t\tsetInViewport(element, false);\r\n\t\t}\r\n\t},\r\n\t_onIntersection: function(entries) {\r\n\t\tentries.forEach(this._manageIntersection.bind(this));\r\n\t\tthis._elements = purgeElements(this._elements);\r\n\t},\r\n\t_setObserver: function() {\r\n\t\tif (!supportsIntersectionObserver) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._observer = new IntersectionObserver(\r\n\t\t\tthis._onIntersection.bind(this),\r\n\t\t\tgetObserverSettings(this._settings)\r\n\t\t);\r\n\t},\r\n\r\n\tloadAll: function() {\r\n\t\tthis._elements.forEach(element => {\r\n\t\t\tthis.load(element);\r\n\t\t});\r\n\t\tthis._elements = purgeElements(this._elements);\r\n\t},\r\n\r\n\tupdate: function(elements) {\r\n\t\tconst settings = this._settings;\r\n\t\tconst nodeSet =\r\n\t\t\telements ||\r\n\t\t\tsettings.container.querySelectorAll(settings.elements_selector);\r\n\r\n\t\tthis._elements = purgeElements(Array.prototype.slice.call(nodeSet)); // nodeset to array for IE compatibility\r\n\r\n\t\tif (isBot || !this._observer) {\r\n\t\t\tthis.loadAll();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._elements.forEach(element => {\r\n\t\t\tthis._observer.observe(element);\r\n\t\t});\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tif (this._observer) {\r\n\t\t\tpurgeElements(this._elements).forEach(element => {\r\n\t\t\t\tthis._observer.unobserve(element);\r\n\t\t\t});\r\n\t\t\tthis._observer = null;\r\n\t\t}\r\n\t\tthis._elements = null;\r\n\t\tthis._settings = null;\r\n\t},\r\n\r\n\tload: function(element, force) {\r\n\t\trevealElement(element, this._settings, force);\r\n\t}\r\n};\r\n\r\n/* Automatic instances creation if required (useful for async script loading) */\r\nif (runningOnBrowser) {\r\n\tautoInitialize(LazyLoad, window.lazyLoadOptions);\r\n}\n\nreturn LazyLoad;\n\n})));\n"]}